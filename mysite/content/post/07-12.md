+++
title = "2018-07-12"
weight = 99
+++

##Docker学习 

1.docker的概念：Docker 最初是 dotCloud 公司创始人 Solomon Hykes 在法国期间发起的一个公司内部项目，
             它是基于 dotCloud 公司多年云服务技术的一次革新，主要项目代码在 GitHub 上进行维护。
2.特点：Go 语言进行开发实现；
        基于 Linux 内核的cgroup，namespace，以及 AUFS 类的 Union FS 等技术；
        对进程进行封装隔离；
        属于操作系统层面的虚拟化技术
3.区别：传统虚拟机技术是虚拟出一套硬件后，在其上运行一个完整操作系统，在该系统上再运行所需应用进程；
        而容器内的应用进程直接运行于宿主的内核，容器内没有自己的内核，而且也没有进行硬件虚拟。
4.优势：高效的利用系统资源
        更快的启动时间
        一致的运行环境
        持续交付和部署
        更轻松的迁移
        易于维护扩展
5.基本概念：docker镜像：一个特殊的文件系统，除了提供容器运行时所需的程序、库、资源、配置等文件外，
                      还包含了一些为运行时准备的一些配置参数（如匿名卷、环境变量、用户等）。
                     （镜像不包含任何动态数据，其内容在构建之后也不会被改变。）
           docker容器：镜像（Image）和容器（Container）的关系，就像是面向对象程序设计中的类和实例
                      一样，镜像是静态的定义，容器是镜像运行时的实体。其实质是进程。
                     （容器可以被创建、启动、停止、删除、暂停等。）
           Docker Registry：集中存储、分发镜像的服务，与Repository为一对一或一对多关系。
                          （每个仓库包可含多个标签，每个标签对应一个镜像）
6.Docker镜像：（1）获取镜像：docker pull是从docker registry获取镜像的命令
                          （docker pull [选项] [Docker Registry地址]<仓库名>:<标签>）
                           ps：Docker Registry地址：<域名/IP>[:端口号] 默认地址是 Docker Hub
                               ‘/仓库名：<用户名>/<软件名>

              （2）运行：以镜像为基础启动一个容器来运行 $ docker run -it --rm ubuntu:14.04 bash
                         docker run   运行容器的命令
                         -it          两个参数，一个是 -i 交互式操作，一个是 -t 终端。
                         --rm         这个参数是说容器退出后随之将其删除。 
                         ubuntu:14.04 这是指用ubuntu:14.04 镜像为基础来启动容器。
                         bash         放在镜像名后的是命令，这里我们希望有个交互式 Shell，因此用的是 bash 。
                         exit         退出了这个容器。

              （3）列镜像：$ docker images（包含仓库名、标签、镜像id、创建时间、占用空间）
                          ps：Docker Hub中显示的体积是压缩后的体积。docker images列表中的镜像体积总和并非是所有镜像实际硬盘消耗。

              （4）dockerfile：是一个文本文件，包含了一条条的指令(Instruction)，每一条指令构建一层，就是描述该层应当如何构建。
                   Dockerfile指令：   RUN <命令>（shell格式）         
                                      RUN ["可执行文件","参数1","参数2"]（exec格式）       执行命令

                                      COPY <源路径>... <目标路径>
                                      COPY ["<源路径1>",... "<目标路径>"]                 复制文件

                                      ADD <源路径>... <目标路径>
                                      ADD ["<源路径1>",... "<目标路径>"]                  更高级的复制文件

                                      CMD <命令>（shell格式）
                                      CMD ["可执行文件", "参数1", "参数2"...]（exec格式） 
                                      CMD ["参数1", "参数2"...]（参数列表格式）            容器启动命令
                                      ps：使用 shell 格式的话，实际的命令会被包装为 sh -c 的参数的形式进行执行
                                          例如：CMD echo $HOME 在实际执行中，会将其变更为CMD [ "sh", "-c", "echo $HOME" ]
    
                                      ENV <key> <value>
                                      ENV <key1>=<value1> <key2>=<value2>...             设置环境变量

                                      ARG <参数名>[=<默认值>]                             构建参数

                                      EXPOSE <端口1> [<端口2>...]                         端口声明
                                      ps：只是一个声明，并不意味着开启服务

                                      WORKDIR <工作目录路径>                              指定工作目录  
 
              （5）其他镜像生成方法：   docker import [选项] <文件>|<URL>|- [<仓库名>[:<标签>]]   从rootfs压缩包导入

              （6）使用 docker save 命令可以将镜像保存为归档文件。

              （7）如果要删除本地的镜像，可以使用 docker rmi 命令，其格式为：
                   docker rmi [选项] <镜像1> [<镜像2> ...]
                   ps：docker rm 命令是删除容器，不要混淆。
##今日总结
    看完docker基础知识后，整体感觉docker还是很难，尤其是以前没怎么接触过，但是在使用后工作会很方便，今天在docker下跑了MySQL，感觉还可以，毕竟很多项目需要使用特有的环境，以往每次迁移都要去安装一次软件。
